<Window x:Class="MySchool.Windows.TimetableEditorDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:shell="clr-namespace:System.Windows.Shell;assembly=PresentationFramework"
        Title="Timetable Editor"
        WindowStyle="None"
        ResizeMode="NoResize"
        AllowsTransparency="True"
    Background="Transparent"
        Width="1000"
        Height="550"
        MaxWidth="1000"
        MaxHeight="550"
        MinWidth="1000"
        MinHeight="550"
        WindowStartupLocation="CenterOwner"
    FontFamily="{StaticResource Font.Main}">
    <shell:WindowChrome.WindowChrome>
        <shell:WindowChrome CaptionHeight="40"
          ResizeBorderThickness="0"
      CornerRadius="0"
        GlassFrameThickness="0"
          UseAeroCaptionButtons="False"/>
    </shell:WindowChrome.WindowChrome>

    <Border Background="{DynamicResource Brush.Background}" 
         CornerRadius="16" 
         BorderThickness="1" 
         BorderBrush="{DynamicResource Brush.Primary}">
        <Grid Margin="24">
            <Grid.RowDefinitions>
    <RowDefinition Height="Auto"/>
        <RowDefinition Height="Auto"/>
         <RowDefinition Height="*"/>
<RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- Header (Draggable) -->
        <Grid Grid.Row="0" Margin="0,0,0,16" Background="Transparent" shell:WindowChrome.IsHitTestVisibleInChrome="True">
                <TextBlock Text="Timetable Editor" 
          Style="{StaticResource Text.Headline}"
           VerticalAlignment="Center"/>
           <Button Style="{StaticResource CaptionButton.Close}" 
          HorizontalAlignment="Right" 
 Click="CloseButton_Click"
     ToolTip="Close"
  shell:WindowChrome.IsHitTestVisibleInChrome="True">
 <TextBlock FontFamily="Segoe MDL2 Assets" FontSize="12" Text="&#xE8BB;"/>
        </Button>
  </Grid>

    <!-- Toolbar -->
          <Grid Grid.Row="1" Margin="0,0,0,12">
       <Grid.ColumnDefinitions>
      <ColumnDefinition Width="Auto"/>
       <ColumnDefinition Width="*"/>
   <ColumnDefinition Width="Auto"/>
         </Grid.ColumnDefinitions>

     <!-- Day Selector -->
        <StackPanel Grid.Column="0" Orientation="Horizontal">
       <TextBlock Text="Day:" 
       Style="{StaticResource Text.Body}" 
      VerticalAlignment="Center" 
Margin="0,0,8,0"/>
       <ComboBox x:Name="DayComboBox" 
  Width="150" 
     SelectionChanged="DayComboBox_SelectionChanged"
 Style="{StaticResource ComboBox.Standard}"/>
      </StackPanel>

      <!-- Action Buttons -->
       <StackPanel Grid.Column="2" Orientation="Horizontal">
<Button x:Name="AddPeriodButton" 
      Style="{StaticResource Button.Primary}" 
      Content="Add Period" 
  Padding="12,6"
      Margin="0,0,8,0"
    Click="AddPeriodButton_Click">
    <Button.ContentTemplate>
  <DataTemplate>
      <StackPanel Orientation="Horizontal">
   <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE710;" VerticalAlignment="Center" Margin="0,0,6,0"/>
          <TextBlock Text="Add Period" VerticalAlignment="Center"/>
  </StackPanel>
         </DataTemplate>
   </Button.ContentTemplate>
  </Button>
    <Button x:Name="FindReplaceButton" 
    Style="{StaticResource Button.Secondary}" 
   Content="Find &amp; Replace" 
  Padding="12,6"
     Click="FindReplaceButton_Click"
  ToolTip="Find and replace subject names across all days">
         <Button.ContentTemplate>
      <DataTemplate>
 <StackPanel Orientation="Horizontal">
 <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE8EF;" VerticalAlignment="Center" Margin="0,0,6,0"/>
  <TextBlock Text="Find &amp; Replace" VerticalAlignment="Center"/>
     </StackPanel>
 </DataTemplate>
      </Button.ContentTemplate>
     </Button>
    </StackPanel>
     </Grid>

     <!-- Periods List -->
         <Border Grid.Row="2" 
       Style="{StaticResource Card}" 
                    Padding="0"
    Margin="0,0,0,12">
      <Grid>
          <!-- No periods message -->
      <StackPanel x:Name="NoPeriodsPanel" 
       HorizontalAlignment="Center" 
     VerticalAlignment="Center"
    Visibility="Collapsed">
         <TextBlock FontFamily="Segoe MDL2 Assets" 
  FontSize="48" 
               Text="&#xE8A5;" 
   HorizontalAlignment="Center"
           Foreground="{DynamicResource Brush.Primary}"
            Margin="0,0,0,12"/>
      <TextBlock Style="{StaticResource Text.Title}" 
          Text="No Periods for This Day" 
     HorizontalAlignment="Center"
       Margin="0,0,0,6"/>
  <TextBlock Style="{StaticResource Text.Body}" 
        Text="Click 'Add Period' to create a new period." 
  HorizontalAlignment="Center"
   Foreground="{DynamicResource Brush.TextSecondary}"/>
         </StackPanel>

    <!-- Periods DataGrid -->
           <DataGrid x:Name="PeriodsDataGrid"
        AutoGenerateColumns="False"
 CanUserAddRows="False"
   CanUserDeleteRows="True"
          CanUserReorderColumns="False"
  CanUserSortColumns="True"
    SelectionMode="Single"
  Background="{DynamicResource Brush.Surface}"
          BorderThickness="0"
 GridLinesVisibility="Horizontal"
     HorizontalGridLinesBrush="{DynamicResource Brush.Border}"
   RowHeaderWidth="0"
     HeadersVisibility="Column"
       AlternatingRowBackground="#08000000"
   Margin="12"
 Foreground="{DynamicResource Brush.TextPrimary}"
 FontFamily="{StaticResource Font.Main}">
 <DataGrid.Resources>
 <Style TargetType="DataGridColumnHeader">
 <Setter Property="Background" Value="{DynamicResource Brush.Surface}"/>
 <Setter Property="Foreground" Value="{DynamicResource Brush.TextPrimary}"/>
 <Setter Property="FontWeight" Value="SemiBold"/>
 <Setter Property="Padding" Value="12,8"/>
 <Setter Property="BorderThickness" Value="0,0,0,2"/>
 <Setter Property="BorderBrush" Value="{DynamicResource Brush.Primary}"/>
 <Setter Property="FontFamily" Value="{StaticResource Font.Main}"/>
 </Style>
 <Style TargetType="DataGridCell">
 <Setter Property="Background" Value="Transparent"/>
 <Setter Property="Foreground" Value="{DynamicResource Brush.TextPrimary}"/>
 <Setter Property="BorderThickness" Value="0"/>
 <Setter Property="Padding" Value="8"/>
 <Setter Property="FontFamily" Value="{StaticResource Font.Main}"/>
 <Setter Property="VerticalContentAlignment" Value="Center"/>
 <Setter Property="Template">
 <Setter.Value>
 <ControlTemplate TargetType="DataGridCell">
 <Border Background="{TemplateBinding Background}"
 BorderBrush="{TemplateBinding BorderBrush}"
 BorderThickness="{TemplateBinding BorderThickness}"
 Padding="{TemplateBinding Padding}">
 <ContentPresenter VerticalAlignment="Center" HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"/>
 </Border>
 </ControlTemplate>
 </Setter.Value>
 </Setter>
 <Style.Triggers>
 <Trigger Property="IsSelected" Value="True">
 <Setter Property="Background" Value="#15000000"/>
 <Setter Property="Foreground" Value="{DynamicResource Brush.TextPrimary}"/>
 </Trigger>
 </Style.Triggers>
 </Style>
 <Style TargetType="DataGridRow">
 <Setter Property="Background" Value="Transparent"/>
 <Setter Property="Foreground" Value="{DynamicResource Brush.TextPrimary}"/>
 <Setter Property="FontFamily" Value="{StaticResource Font.Main}"/>
 <Style.Triggers>
 <Trigger Property="IsMouseOver" Value="True">
 <Setter Property="Background" Value="#0A000000"/>
 </Trigger>
 <Trigger Property="IsSelected" Value="True">
 <Setter Property="Background" Value="#15000000"/>
 <Setter Property="Foreground" Value="{DynamicResource Brush.TextPrimary}"/>
 </Trigger>
          <DataTrigger Binding="{Binding IsDragging}" Value="True">
     <Setter Property="Opacity" Value="0.5"/>
         <Setter Property="Background" Value="{DynamicResource Brush.Primary}"/>
              </DataTrigger>
 </Style.Triggers>
 </Style>
 
 <!-- Themed CheckBox Style -->
 <Style TargetType="CheckBox">
 <Setter Property="Foreground" Value="{DynamicResource Brush.TextPrimary}"/>
 <Setter Property="Background" Value="{DynamicResource Brush.Surface}"/>
 <Setter Property="BorderBrush" Value="{DynamicResource Brush.Primary}"/>
 <Setter Property="BorderThickness" Value="2"/>
 <Setter Property="Padding" Value="4,0,0,0"/>
 <Setter Property="VerticalAlignment" Value="Center"/>
 <Setter Property="HorizontalAlignment" Value="Center"/>
 <Setter Property="FontFamily" Value="{StaticResource Font.Main}"/>
 <Setter Property="Template">
 <Setter.Value>
 <ControlTemplate TargetType="CheckBox">
 <Grid Background="Transparent">
 <Border x:Name="CheckBoxBorder"
 Width="20"
 Height="20"
 Background="{TemplateBinding Background}"
 BorderBrush="{TemplateBinding BorderBrush}"
 BorderThickness="{TemplateBinding BorderThickness}"
 CornerRadius="4"
 SnapsToDevicePixels="True">
 <TextBlock x:Name="CheckMark"
 Text="&#xE73E;"
 FontFamily="Segoe MDL2 Assets"
 FontSize="12"
 Foreground="{DynamicResource Brush.Primary}"
 HorizontalAlignment="Center"
 VerticalAlignment="Center"
 Visibility="Collapsed"/>
 </Border>
 </Grid>
 <ControlTemplate.Triggers>
 <Trigger Property="IsChecked" Value="True">
 <Setter TargetName="CheckMark" Property="Visibility" Value="Visible"/>
 <Setter TargetName="CheckBoxBorder" Property="Background" Value="{DynamicResource Brush.Primary}"/>
 <Setter TargetName="CheckMark" Property="Foreground" Value="White"/>
 </Trigger>
 <Trigger Property="IsMouseOver" Value="True">
 <Setter TargetName="CheckBoxBorder" Property="BorderBrush" Value="{DynamicResource Brush.PrimaryDark}"/>
 </Trigger>
 <MultiTrigger>
 <MultiTrigger.Conditions>
 <Condition Property="IsMouseOver" Value="True"/>
 <Condition Property="IsChecked" Value="False"/>
 </MultiTrigger.Conditions>
 <Setter TargetName="CheckBoxBorder" Property="Background">
 <Setter.Value>
 <SolidColorBrush Color="{Binding Source={StaticResource Brush.Primary}, Path=Color}" Opacity="0.1"/>
 </Setter.Value>
 </Setter>
 </MultiTrigger>
 <Trigger Property="IsEnabled" Value="False">
 <Setter TargetName="CheckBoxBorder" Property="Opacity" Value="0.5"/>
 </Trigger>
 </ControlTemplate.Triggers>
 </ControlTemplate>
 </Setter.Value>
 </Setter>
 </Style>
 </DataGrid.Resources>

         <DataGrid.Columns>
          <!-- Period Number -->
  <DataGridTextColumn Header="#" 
     Binding="{Binding PeriodNumber}" 
       Width="60"
            IsReadOnly="True"/>

        <!-- Subject -->
           <DataGridTextColumn Header="Subject" 
  Binding="{Binding Subject, UpdateSourceTrigger=PropertyChanged}" 
       Width="*"
            MinWidth="120"
                 IsReadOnly="False"/>

<!-- Teacher -->
          <DataGridTextColumn Header="Teacher" 
   Binding="{Binding Teacher, UpdateSourceTrigger=PropertyChanged}" 
      Width="*"
       MinWidth="100"
        IsReadOnly="False"/>

        <!-- Room -->
   <DataGridTextColumn Header="Room" 
Binding="{Binding Room, UpdateSourceTrigger=PropertyChanged}" 
      Width="100"
          IsReadOnly="False"/>

  <!-- Start Time -->
   <DataGridTextColumn Header="Start Time" 
Binding="{Binding StartTime, UpdateSourceTrigger=PropertyChanged}" 
            Width="100"
  IsReadOnly="False"/>

    <!-- End Time -->
     <DataGridTextColumn Header="End Time" 
         Binding="{Binding EndTime, UpdateSourceTrigger=PropertyChanged}" 
     Width="100"
            IsReadOnly="False"/>

         <!-- Is Break -->
 <DataGridCheckBoxColumn Header="Break" 
     Binding="{Binding IsBreak, UpdateSourceTrigger=PropertyChanged}" 
     Width="70"
     IsReadOnly="False">
     <DataGridCheckBoxColumn.ElementStyle>
         <Style TargetType="CheckBox" BasedOn="{StaticResource {x:Type CheckBox}}">
   <Setter Property="HorizontalAlignment" Value="Center"/>
      <Setter Property="VerticalAlignment" Value="Center"/>
       <Setter Property="IsHitTestVisible" Value="True"/>
         </Style>
     </DataGridCheckBoxColumn.ElementStyle>
     <DataGridCheckBoxColumn.EditingElementStyle>
         <Style TargetType="CheckBox" BasedOn="{StaticResource {x:Type CheckBox}}">
             <Setter Property="HorizontalAlignment" Value="Center"/>
   <Setter Property="VerticalAlignment" Value="Center"/>
   <Setter Property="IsHitTestVisible" Value="True"/>
         </Style>
     </DataGridCheckBoxColumn.EditingElementStyle>
 </DataGridCheckBoxColumn>

      <!-- Delete Button -->
      <DataGridTemplateColumn Header="Actions" Width="80">
         <DataGridTemplateColumn.CellTemplate>
          <DataTemplate>
     <Button Style="{StaticResource Button.Secondary}" 
  Content="Delete" 
        Padding="8,4"
             FontSize="11"
     Click="DeletePeriodButton_Click"
         Tag="{Binding}">
             <Button.ContentTemplate>
            <DataTemplate>
       <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE74D;" FontSize="12"/>
          </DataTemplate>
               </Button.ContentTemplate>
  </Button>
   </DataTemplate>
    </DataGridTemplateColumn.CellTemplate>
   </DataGridTemplateColumn>
        </DataGrid.Columns>
   </DataGrid>
             </Grid>
            </Border>

<!-- Action Buttons -->
 <StackPanel Grid.Row="3" Orientation="Horizontal" HorizontalAlignment="Right">
      <Button Style="{StaticResource Button.Secondary}" 
Content="Cancel" 
       Padding="16,8"
           Margin="0,0,8,0"
             Click="CancelButton_Click"/>
            <Button x:Name="SaveButton" 
Style="{StaticResource Button.Primary}" 
          Content="Save Changes" 
        Padding="16,8"
             Click="SaveButton_Click"/>
     </StackPanel>
    </Grid>
    </Border>
</Window>
